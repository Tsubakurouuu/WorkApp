<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--Mapperとxmlのマッピング-->
<mapper namespace="com.example.repository.RequestFormMapper">
	<!--マッピング定義(申請フォーム)-->
	<resultMap id="requestForm" type="com.example.model.RequestForm">
		<id column="id" property="id"/>
		<result column="user_id" property="userId"/>
		<result column="work_id" property="workId"/>
		<result column="year" property="year"/>
		<result column="month" property="month"/>
		<result column="date" property="date"/>
		<result column="work_status" property="workStatus"/>
		<result column="attendance_hour" property="attendanceHour"/>
		<result column="attendance_minute" property="attendanceMinute"/>
		<result column="leaving_hour" property="leavingHour"/>
		<result column="leaving_minute" property="leavingMinute"/>
		<result column="rest_hour" property="restHour"/>
		<result column="rest_minute" property="restMinute"/>
		<result column="comment" property="comment"/>
		<association property="work" resultMap="work" columnPrefix="work_"/>
		<association property="mUser" resultMap="user" columnPrefix="user_"/>
	</resultMap>
	<!--マッピング定義(勤怠)-->
	<resultMap id="work" type="com.example.model.Work">
		<id column="id" property="id"/>
		<result column="user_id" property="userId"/>
		<result column="year" property="year"/>
		<result column="month" property="month"/>
		<result column="date" property="date"/>
		<result column="attendance_hour" property="attendanceHour"/>
		<result column="attendance_minute" property="attendanceMinute"/>
		<result column="leaving_hour" property="leavingHour"/>
		<result column="leaving_minute" property="leavingMinute"/>
		<result column="rest_hour" property="restHour"/>
		<result column="rest_minute" property="restMinute"/>
		<result column="working_time_hour" property="workingTimeHour"/>
		<result column="working_time_minute" property="workingTimeMinute"/>
		<result column="over_time_hour" property="overTimeHour"/>
		<result column="over_time_minute" property="overTimeMinute"/>
		<result column="work_status" property="workStatus"/>
	</resultMap>
	<!--マッピング定義(ユーザー)-->
	<resultMap id="user" type="com.example.model.MUser">
		<id column="id" property="id"/>
		<result column="user_id" property="userId"/>
		<result column="password" property="password"/>
		<result column="last_name" property="lastName"/>
		<result column="first_name" property="firstName"/>
		<result column="birthday" property="birthday"/>
		<result column="role" property="role"/>
	</resultMap>
	<!--申請フォーム登録-->
	<insert id="insertForm">
		insert 
		into 
			request_form (
				user_id,
				work_id,
				year,
				month,
				date,
				work_status,
				attendance_hour,
				attendance_minute,
				leaving_hour,
				leaving_minute,
				rest_hour,
				rest_minute,
				comment
			) 
		values (
			#{userId},
			#{workId},
			#{year},
			#{month},
			#{date},
			#{workStatus},
			#{attendanceHour},
			#{attendanceMinute},
			#{leavingHour},
			#{leavingMinute},
			#{restHour},
			#{restMinute},
			#{comment}
		)
	</insert>
	<!--申請フォーム一覧取得-->
	<select id="selectRequestFormList" resultMap="requestForm" resultType="RequestForm">
		select
			request_form.id,
			request_form.user_id,
			request_form.work_id,
			request_form.year,
			request_form.month,
			request_form.date,
			request_form.work_status,
			request_form.attendance_hour,
			request_form.attendance_minute,
			request_form.leaving_hour,
			request_form.leaving_minute,
			request_form.rest_hour,
			request_form.rest_minute,
			request_form.comment,
			work.id as work_id,
			work.user_id as work_user_id,
			work.year as work_year,
			work.month as work_month,
			work.date as work_date,
			work.attendance_hour as work_attendance_hour,
			work.attendance_minute as work_attendance_minute,
			work.leaving_hour as work_leaving_hour,
			work.leaving_minute as work_leaving_minute,
			work.rest_hour as work_rest_hour,
			work.rest_minute as work_rest_minute,
			work.working_time_hour as work_working_time_hour,
			work.working_time_minute as work_working_time_minute,
			work.over_time_hour as work_over_time_hour,
			work.over_time_minute as work_over_time_minute,
			work.work_status as work_work_status,
			m_user.id as user_id,
			m_user.user_id as user_user_id,
			m_user.password as user_password,
			m_user.first_name as user_first_name,
			m_user.last_name as user_last_name,
			m_user.birthday as user_birthday,
			m_user.role as user_role
		from
			request_form
		left
		join
			work
		on
			request_form.work_id = work.id
		left
		join
			m_user
		on
			work.user_id = m_user.id
	</select>
	<!--申請フォーム詳細取得-->
	<select id="selectRequestFormDetail" resultMap="requestForm" resultType="RequestForm">
		select
			request_form.id,
			request_form.user_id,
			request_form.work_id,
			request_form.year,
			request_form.month,
			request_form.date,
			request_form.work_status,
			request_form.attendance_hour,
			request_form.attendance_minute,
			request_form.leaving_hour,
			request_form.leaving_minute,
			request_form.rest_hour,
			request_form.rest_minute,
			request_form.comment,
			work.id as work_id,
			work.user_id as work_user_id,
			work.year as work_year,
			work.month as work_month,
			work.date as work_date,
			work.attendance_hour as work_attendance_hour,
			work.attendance_minute as work_attendance_minute,
			work.leaving_hour as work_leaving_hour,
			work.leaving_minute as work_leaving_minute,
			work.rest_hour as work_rest_hour,
			work.rest_minute as work_rest_minute,
			work.working_time_hour as work_working_time_hour,
			work.working_time_minute as work_working_time_minute,
			work.over_time_hour as work_over_time_hour,
			work.over_time_minute as work_over_time_minute,
			work.work_status as work_work_status
		from
			request_form
		left
		join
			work
		on
			request_form.work_id = work.id
		where
			request_form.id = #{id}
	</select>
</mapper>